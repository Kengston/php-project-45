#!/usr/bin/env php
<?php

require_once __DIR__ . '/../../vendor/autoload.php';

use BrainGames\Cli;
use function cli\line;
use function cli\prompt;

function runBrainCalc(string $name): void {
    line('What is the result of the expression?');

    $numCount = 3;

    for ($i = 0; $i < $numCount; $i++) {
        $keyArray = ["*", "+", "-"];
        $randomKey = $keyArray[array_rand($keyArray)];
        $firstNum = rand(1, 100);
        $secondNum = rand(1, 100);
        $questionCount = $firstNum . " " . $randomKey . " " . $secondNum;

        switch ($randomKey) {
            case "+":
                $realAnswer = $firstNum + $secondNum;
                break;
            case "*":
                $realAnswer = $firstNum * $secondNum;
                break;
            case "-":
                $realAnswer = $firstNum - $secondNum;
                break;
        }

        line("Question: {$questionCount}");
        $userAnswer = prompt('Your answer');

        if ($userAnswer != $realAnswer) {
            line("'{$userAnswer}' is wrong answer ;(. Correct answer was '{$realAnswer}'.");
            line("Let's try again, {$name}!");
            return;
        }

        line('Correct!');
    }

    line("Congratulations, {$name}!");
}

$name = Cli\welcomeUser();
runBrainCalc($name);